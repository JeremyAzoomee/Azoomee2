<!DOCTYPE HTML>
	<head>
	
	</head>
	<body bgcolor="black">
		
		<script src="./jwplayer/jwplayer.js"></script>
		<script>jwplayer.key="wrR1ClbRkYGQx0IOIV2gMJQggtFCdWaDaza25g==";</script>

		<div id="videoPlayer"></div>
		<script type="text/javascript">
			var sent0 = false;
			var sent25 = false;
			var sent50 = false;
			var sent75 = false;
		
			var contentUrl = getUrlVars()["contentUrl"];
			var playerInstance = jwplayer("videoPlayer");
			
			var receivedPlaylist = NativeInterface.getVideoPlaylist();
			
			var contentUrl = getUrlVars()["contentUrl"];
			var playerInstance = jwplayer("videoPlayer");
		
			var playListArray = [];
			var jumpToThisElement = -1;
			
			if(receivedPlaylist == "noPlaylist")
			{
				playListArray.push({file: contentUrl, mediaid: "episode"});
				jumpToThisElement = 0;
			}
			else
			{
				var uriListArray = receivedPlaylist.split("|");
				for(i = 0; i < uriListArray.length; i++)
				{
					var uri = uriListArray[i].split("*")[0];
					var imageuri = uriListArray[i].split("*")[1];
					var titleText = uriListArray[i].split("*")[2];
					
					playListArray.push({file: uri, mediaid: "episode", image: imageuri, title: titleText});
					if(uri == contentUrl) jumpToThisElement = i;
				}
			}
			
			playerInstance.setup
			({
    			playlist: playListArray,
    			repeat: false,
    			stretching: "exactfit",
    			mediaid: "azoomeeplayer",
    			height: "100%",
      			width: "100%"
			});
			
			jwplayer().playlistItem(jumpToThisElement);
			
			jwplayer().on('error', function(event){
				console.log("error");
				getBackToLoginScreen();
			});
			
			jwplayer().on('setupError', function(event){
				console.log("setupError");
				getBackToLoginScreen();
			});
			
			jwplayer().on('play', function(event){
				console.log("play");
				if(document.getElementById("loadingScreen"))
				{
					var loadingScreen = document.getElementById("loadingScreen");
					loadingScreen.parentElement.removeChild(loadingScreen);
				}
				
				NativeInterface.sendMediaPlayerData("play", "");
			});
			
			jwplayer().on('ready', function(event){
				var loadingScreen = document.getElementById("loadingScreen");
				loadingScreen.innerHTML = '<center><button onClick="startPlayBack()" style="margin-top: 24.5%; width: 15%; background-color: Transparent; border: none;"><img src="play.png" style="width: 50%;"></button></center>';
			});
			
			jwplayer().on('pause', function(event){
				console.log("Pause");
				NativeInterface.sendMediaPlayerData("pause", "");
			});
			
			jwplayer().on('visualQuality', function(event){
				var currentQuality = jwplayer().getVisualQuality().level;
				console.log("Visualquality: " + currentQuality["width"] + ", " + currentQuality["height"] + ", " + currentQuality["label"]);
				NativeInterface.sendMediaPlayerData("quality", currentQuality["height"]);
			});
			
			jwplayer().on('time', function(event){
				var totalDuration = jwplayer().getDuration();
				var currentPosition = jwplayer().getPosition();
				
				var percentage = currentPosition / totalDuration * 100;
				
				if((percentage > 0)&&(!sent0))
				{
					sent0 = true;
					console.log("0%");
					NativeInterface.sendMediaPlayerData("time", "0");
				}
				if((percentage > 25)&&(!sent25))
				{
					sent25 = true;
					console.log("25%");
					NativeInterface.sendMediaPlayerData("time", "25");
				}
				if((percentage > 50)&&(!sent50))
				{
					sent50 = true;
					console.log("50%");
					NativeInterface.sendMediaPlayerData("time", "50");
				}
				if((percentage > 75)&&(!sent75))
				{
					sent75 = true;
					console.log("75%");
					NativeInterface.sendMediaPlayerData("time", "75");
				}
			});
			
			jwplayer().on('complete', function(event){
				console.log("complete");
				NativeInterface.sendMediaPlayerData("complete", "");
			});
			
			jwplayer().on('playlistComplete', function(event){
					NativeInterface.exitView();
				});
			
			jwplayer().on('firstFrame', function(event){
				console.log("firstFrame");
				var loadtime = event.loadTime;
				NativeInterface.sendMediaPlayerData("firstFrame", loadtime.toString());
			});
		
			function getUrlVars() 
			{
				var vars = {};
				var parts = window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi, function(m,key,value) 
				{
					vars[key] = value;
				});
				return vars;
			}
			
			function startPlayBack()
			{
				jwplayer().play(true);
				var loadingScreen = document.getElementById("loadingScreen");
				loadingScreen.innerHTML = '<center><img src="load.png" style="margin-top: 24.5%; width: 15%;"></center>';
			}
			
			function getBackToLoginScreen()
			{
				console.log("getBackToLoginScreen found!");
				NativeInterface.errorOccurred();
			}
</script>
<style type="text/css">
			html,body 
			{ 
				height:100%; 
				width:100%; 
				padding:0; 
				margin:0; 
			}
			
			#videoPlayer
			{
				height:100%;
				width:100%; 
				padding:0; 
			}
		</style>
		<div id="loadingScreen" style="position: absolute; left: 0px; top: 0px; background-image: url(./loading_bg.jpg); width: 100%; height: 100vh; background-size: 100%; background-repeat: no-repeat;">
			<center><img src="load.png" style="margin-top: 24.5%; width: 15%;"></center>
		</div>
	</body>
</html>